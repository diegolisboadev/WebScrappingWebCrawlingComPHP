

$(document).ready(function() {

    $.ajax({
        url: "/webAjaxAll",
        type: 'GET',
        dataType: 'json',
        cache: false,
    beforeSend: function() {
        $('.init').show();
    },
    }).done(function(dataAll) {
        if(dataAll.uniao.stc.original.erro === true)
            erroAlerta();
        $(".init").hide();
        listaAllNotices(dataAll)
    });

    /**
     * Lista todas as noticias
     * @param {Array} dataAll
     */
    function listaAllNotices(dataAll) {

        var component_all = '';

        // Seplan Noticias
        for(var i = 0; i < dataAll.uniao.seplan.length; i++) {
            component_all = forHtmlNotices(dataAll.uniao.seplan[i]['data'],
                "https://seplan.ma.gov.br/files/2019/10/logo-secretarias-seplan.jpg",
                dataAll.uniao.seplan[i]['titulo'][1],
                dataAll.uniao.seplan[i]['titulo'][0], component_all);
        }

        // Minitério da Justiça Senasp
        for(var mj = 0; mj < dataAll.uniao.minJus.original.length; mj++) {
            component_all = forHtmlNotices(dataAll.uniao.minJus.original[mj]['data'].replace('-', '').trim(),
            '/images/maxresdefault.png', dataAll.uniao.minJus.original[mj]['titulo_link'][1],
            dataAll.uniao.minJus.original[mj]['titulo_link'][0], component_all);
        }

        // TCU
        for(var tc = 0; tc < dataAll.uniao.tcu.original.length; tc++) {
            component_all = forHtmlNotices(dataAll.uniao.tcu.original[tc]['data'].replace('-', '').trim(),
            'https://portal.tcu.gov.br/portaltcu2017/images/TCU.svg',
            'https://portal.tcu.gov.br'+dataAll.uniao.tcu.original[tc]['link'].replace('..', ''),
            dataAll.uniao.tcu.original[tc]['titulo'], component_all);
        }

        // Tcema Noticias
        for(var t = 0; t < dataAll.uniao.tcema.length; t++) {
            component_all = forHtmlNotices(dataAll.uniao.tcema[t]['data'],
                "https://site.tce.ma.gov.br/images/logo_tce_new.png",
                "http://site.tce.ma.gov.br/"+dataAll.uniao.tcema[t]['link_texto'][1],
                dataAll.uniao.tcema[t]['link_texto'][0], component_all);
        }

        // BB Noticias
        for(var b = 0; b < (dataAll.uniao.bb.original.length - 870); b++) {
            component_all = forHtmlNotices(dataAll.uniao.bb.original[b]['data'],
                "http://www.2viaboleto.com.br/wp-content/uploads/2014/08/Banco-do-Brasil.png",
                dataAll.uniao.bb.original[b]['link_texto'][1],
                dataAll.uniao.bb.original[b]['link_texto'][0], component_all);
        }

        // Policia Civil MA Noticias
        for(var pc = 0; pc < dataAll.uniao.pc.original.length; pc++) {
            component_all = forHtmlNotices(dataAll.uniao.pc.original[pc]['data'],
                "https://eloconcursos.com.br/blog/wp-content/uploads/2017/12/Pol%C3%ADcia-Civil-MA.png",
                dataAll.uniao.pc.original[pc]['link_texto'][pc][0],
                dataAll.uniao.pc.original[pc]['link_texto'][pc][1], component_all);
        }

        // Corpo de Bombeiros M. MA Noticias
        for(var cbm = 0; cbm < dataAll.uniao.cbm.original.length; cbm++) {
            component_all = forHtmlNotices(dataAll.uniao.cbm.original[cbm]['data'],
                "/images/Bombeiros-Militar-brasão.jpg",
                dataAll.uniao.cbm.original[cbm]['link_texto'][cbm][0],
                dataAll.uniao.cbm.original[cbm]['link_texto'][cbm][1], component_all);
        }

        // POlicia Militar MA Noticias
        for(var pm = 0; pm < dataAll.uniao.pm.original.length; pm++) {
            component_all = forHtmlNotices(dataAll.uniao.pm.original[pm]['data'],
                "https://1.bp.blogspot.com/-eLAHiDCDWlw/VxLzT8W7hrI/AAAAAAAAKmI/DNQv5xNAvUE9fAmYn9zXu1bwK_5j8MJQACLcB/s1600/nonato.jpg",
                dataAll.uniao.pm.original[pm]['link_texto'][0],
                dataAll.uniao.pm.original[pm]['link_texto'][1], component_all);
        }

        $('#carousel_slide_all').html(component_all);
        $('#carousel_slide_all .carousel-item').first().addClass('active');
        $('.carousel-indicators > li').first().addClass('active');
    }

    /**
     * Html de inserção dos dados das Noticias
     *
     * @param {Array} dataAll
     * @param {string} image
     * @param {string} data
     * @param {string} link
     * @param {string} titulo
     * @param {string} component_all
     */
    function forHtmlNotices(data, image, link, titulo, component_all) {
        component_all += "<div class='carousel-item'>";
        component_all += "<div class='row justify-content-center'>";
        component_all += "<img style='width:15% !important;height:15% !important;' class='d-inline-block p-3 img-fluid float-left rounded' src='"+image+"' alt='"+titulo+"'>";
        component_all += "<div class='col-md-6 mt-3'>";
        component_all += "<a target='_blank' class='text-dark' href='"+link+"' style='text-decoration:none;'>";
        component_all += "<h4 class='font-weight-bold'>"+data+ " - " +titulo+"</h4>";
        component_all += "</a>";
        component_all += "</div>";
        component_all += "</div>";
        component_all += "</div>";

        return component_all;
    }

    // Alerta Erro Array Null Crawling
    function erroAlerta() {
        return Swal.fire({
            title: 'Ops!',
            text: 'Algo errado com {}! Informe a SUINF!',
            icon: 'warning',
            confirmButtonText: 'Continuar'
          });
    }

    // Reload Page Após 5 Minutos Automaticamente
    // setTimeout("window.location.reload(true);", 20000);

    // CLick em Input Button TCU para mostrar 10 Noticias
    $('#bt_load_more').click(function() {console.info('Click Ok!')});

    // Init Carrousel
    $('.carousel').carousel({
        interval: 8000,
        ride: true
    });

});

